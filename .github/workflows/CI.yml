name: CI
on: push

jobs:
    posix-build:
        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                os: [ubuntu-latest, macos-latest]
        steps:
        - uses: actions/checkout@v2
        - name: Install Dependencies
          run: |
              echo ${VCPKG_ROOT}
              vcpkg install catch2
        - name: Build Debug
          run: ./build.sh
        - name: Build Release
          run: ./buildRelease.sh
    windows-build:
      runs-on: windows-latest
      steps:
      - uses: actions/checkout@v2
      - name: Setup MSBuild.exe
        uses: warrenbuckley/Setup-MSBuild@v1
      - name: Build Debug
        run: |
          cmake --config=Debug .
          msbuild PaperTrader.sln
      - name: Build Release
        run: |
          cmake --config=Release .
          msbuild PaperTrader.sln
    docker-build:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v2
        - name: Checkout submodules
          uses: textbook/git-checkout-submodule-action@master
        - name: Build Debug
          run: |
            ./buildDocker.sh
        - name: Build Release
          run: |
            ./buildDockerRelease.sh
